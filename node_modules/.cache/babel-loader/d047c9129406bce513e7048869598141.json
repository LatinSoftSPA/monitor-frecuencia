{"ast":null,"code":"import _slicedToArray from\"/home/mvera/Documentos/LATINSOFT/REACT JS/APP MONITORES/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{GoogleMap,Marker,InfoWindow,KmlLayer,TrafficLayer,DrawingManager,useLoadScript}from'@react-google-maps/api';import{STYLE_CONTAI,MAPA_OPTION,MAPA_CENTER,KEY_GOOGLE}from\"./mapConfig\";import{ICON_CFG}from\"./iconConfig\";import Loading from'../Loading';import Error500 from'../Errors/500';var Index=function Index(props){var moviles=props.moviles,rutas=props.rutas;var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),map=_React$useState2[0],setMap=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),markers=_React$useState4[0],setMarkers=_React$useState4[1];var _React$useState5=React.useState(null),_React$useState6=_slicedToArray(_React$useState5,2),selected=_React$useState6[0],setSelected=_React$useState6[1];var _useLoadScript=useLoadScript({// googleMapsApiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY\ngoogleMapsApiKey:KEY_GOOGLE}),isLoaded=_useLoadScript.isLoaded,loadError=_useLoadScript.loadError;var mapRef=React.useRef();var onMapLoad=React.useCallback(function(map){mapRef.current=map;},[]);var panTo=React.useCallback(function(_ref){var lat=_ref.lat,lng=_ref.lng;mapRef.current.panTo({lat:lat,lng:lng});mapRef.current.setZoom(14);},[]);var onUnmount=React.useCallback(function callback(map){setMap(null);},[]);var renderRutas=function renderRutas(listado){var kml=[];listado.map(function(obj,i){return kml.push(/*#__PURE__*/React.createElement(KmlLayer,{key:i,url:obj}));});return kml;};var crearMarker=function crearMarker(obj){var Codigo=obj.Codigo,Patente=obj.Patente,Movil=obj.Movil;var eve=obj.Eventos[0];var Heading=eve.Heading,Velocidad=eve.Velocidad,Fecha=eve.Fecha,Hora=eve.Hora;var pos={lat:eve.Latitud,lng:eve.Longitud};var marker=renderMarker(Codigo,Patente,Movil,pos,Heading,Velocidad,Hora,Fecha);return marker;};var renderMarker=function renderMarker(cod,ppu,mov,pos,gra,spd,hor,fec){var tittle=\"MAQ: \".concat(mov,\"|PPU: \").concat(ppu);return/*#__PURE__*/React.createElement(Marker,{key:cod,title:tittle,id:cod,name:ppu,position:pos,mapCenter:pos,draggable:false//onClick   = { this.onMarkerClick }\n,icon:ICON_CFG(gra,spd)//label     = { ppu }\n,hora:hor,fecha:fec,velocidad:spd,grados:gra,movil:mov});};if(loadError)return/*#__PURE__*/React.createElement(Error500,null);if(!isLoaded)return/*#__PURE__*/React.createElement(Loading,null);return/*#__PURE__*/React.createElement(\"div\",{className:\"boxMapa\"},/*#__PURE__*/React.createElement(GoogleMap,{mapContainerStyle:STYLE_CONTAI,options:MAPA_OPTION,onLoad:onMapLoad,onUnmount:onUnmount,zoom:1,center:MAPA_CENTER},rutas.length>0?renderRutas(rutas):null,moviles.map(function(obj){return obj.Eventos.length>0?crearMarker(obj):null;}),/*#__PURE__*/React.createElement(TrafficLayer,null)));};export default React.memo(Index);","map":{"version":3,"sources":["/home/mvera/Documentos/LATINSOFT/REACT JS/APP MONITORES/src/componets/Mapa/index.jsx"],"names":["React","GoogleMap","Marker","InfoWindow","KmlLayer","TrafficLayer","DrawingManager","useLoadScript","STYLE_CONTAI","MAPA_OPTION","MAPA_CENTER","KEY_GOOGLE","ICON_CFG","Loading","Error500","Index","props","moviles","rutas","useState","map","setMap","markers","setMarkers","selected","setSelected","googleMapsApiKey","isLoaded","loadError","mapRef","useRef","onMapLoad","useCallback","current","panTo","lat","lng","setZoom","onUnmount","callback","renderRutas","listado","kml","obj","i","push","crearMarker","Codigo","Patente","Movil","eve","Eventos","Heading","Velocidad","Fecha","Hora","pos","Latitud","Longitud","marker","renderMarker","cod","ppu","mov","gra","spd","hor","fec","tittle","length","memo"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { GoogleMap, Marker, InfoWindow, KmlLayer, TrafficLayer, DrawingManager, useLoadScript } from '@react-google-maps/api';\nimport { STYLE_CONTAI, MAPA_OPTION, MAPA_CENTER, KEY_GOOGLE } from \"./mapConfig\";\nimport { ICON_CFG } from \"./iconConfig\"\n\n\nimport Loading  from '../Loading';\nimport Error500 from '../Errors/500';\n\nconst Index = (props) => {\n    const { moviles, rutas } = props;\n    const [map, setMap] = React.useState(null);\n    const [markers, setMarkers] = React.useState([]);\n    const [selected, setSelected] = React.useState(null);\n\n    const { isLoaded, loadError } = useLoadScript({\n        // googleMapsApiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY\n        googleMapsApiKey: KEY_GOOGLE\n    });\n \n    const mapRef = React.useRef();\n    const onMapLoad = React.useCallback((map) => {\n        mapRef.current = map;\n    }, []);\n\n    const panTo = React.useCallback(({ lat, lng }) => {\n        mapRef.current.panTo({ lat, lng });\n        mapRef.current.setZoom(14);\n    }, []);\n\n    const onUnmount = React.useCallback(function callback(map) {\n        setMap(null);\n    }, []);\n \n    \n    const renderRutas = (listado) => {\n        let kml = [];\n        listado.map( (obj, i) => kml.push(<KmlLayer key={i} url={obj} />) );\n        return kml;\n    }\n\n    const crearMarker = (obj) => {\n        const { Codigo, Patente, Movil} = obj;\n        const eve = obj.Eventos[0];\n        const { Heading, Velocidad, Fecha, Hora } = eve;\n        const pos = { lat : eve.Latitud, lng: eve.Longitud };\n        const marker = renderMarker(Codigo, Patente, Movil, pos, Heading, Velocidad, Hora, Fecha);\n        return marker;\n    }\n\n    const renderMarker = (cod, ppu, mov,  pos, gra, spd, hor, fec) => {\n        const tittle = `MAQ: ${mov}|PPU: ${ppu}`;\n        return (\n          <Marker  \n            key       = { cod } \n            title     = { tittle }\n            id        = { cod } \n            name      = { ppu }\n            position  = { pos } \n            mapCenter = { pos }\n            draggable = { false }\n            //onClick   = { this.onMarkerClick }\n            icon      = { ICON_CFG(gra, spd) }\n            //label     = { ppu }\n            hora      = { hor }\n            fecha     = { fec }\n            velocidad = { spd }\n            grados    = { gra }\n            movil     = { mov }\n          />\n        )\n      }\n\n    if (loadError) return <Error500 />;\n    if (!isLoaded) return <Loading />;\n\n    return (\n        <div className=\"boxMapa\">\n            <GoogleMap \n                mapContainerStyle={ STYLE_CONTAI } \n                options={ MAPA_OPTION }\n                onLoad={onMapLoad}\n                onUnmount={onUnmount} \n                zoom={1} \n                center={ MAPA_CENTER } \n            >\n                { rutas.length > 0 ? renderRutas(rutas) : null }\n                { moviles.map(obj => (obj.Eventos.length > 0 ? crearMarker(obj): null) )}\n                \n\n                <TrafficLayer />\n\n            </GoogleMap>\n        </div>\n    )\n}\n\nexport default React.memo(Index);"]},"metadata":{},"sourceType":"module"}